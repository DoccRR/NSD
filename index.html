<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>NSD Portal</title>
  <style>
    :root {
      --bg: #0a0a0a;
      --fg: #f0f0f0;
      --accent: #ff0033;
      --panel: #1a1a1a;
    }
    body {
      margin: 0; padding: 0;
      background: var(--bg);
      color: var(--fg);
      font-family: "Segoe UI", Tahoma, sans-serif;
      overflow-x: hidden;
      overflow-y: hidden;
    }
    .carousel {
      display: flex;
      overflow-x: auto;
      overflow-y: hidden;
      height: 100vh;
      scroll-snap-type: x mandatory;
      scroll-behavior: smooth;
    }
    .section {
      flex: 0 0 100%;
      height: 100vh;
      scroll-snap-align: start;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }
    .panel {
      background: var(--panel);
      padding: 2rem;
      border-radius: 12px;
      text-align: center;
      max-width: 500px;
      box-shadow: 0 0 20px rgba(0,0,0,0.6);
    }
    h1, h2 {
      margin: 0.5em 0;
    }
    a {
      color: var(--accent);
      text-decoration: none;
      display: inline-block;
      margin: 0.25em;
    }
    #snakeCanvas {
      background: #000;
      display: block;
      margin: auto;
      border: 2px solid var(--fg);
    }
    #snakeUI {
      margin-top: 1em;
    }
    #ranking {
      margin-top: 1em;
      text-align: left;
      max-height: 150px;
      overflow-y: auto;
      background: rgba(255,255,255,0.05);
      padding: 0.5em;
      border-radius: 8px;
    }
    .overlay {
      position: absolute;
      top:0; left:0; right:0; bottom:0;
      background: rgba(0,0,0,0.85);
      color: white;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      font-size: 1.5em;
      z-index: 10;
    }
    .arrow {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      font-size: 2em;
      color: var(--fg);
      cursor: pointer;
      background: rgba(0,0,0,0.4);
      padding: 0.2em 0.5em;
      border-radius: 50%;
      user-select: none;
    }
    .arrow.left { left: 10px; }
    .arrow.right { right: 10px; }
    #soundcloud-player {
      margin-top: 1em;
    }
    .sc-controls {
      margin-top: 0.5em;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1em;
    }
    .sc-controls button {
      background: var(--accent);
      border: none;
      padding: 0.5em 1em;
      border-radius: 6px;
      cursor: pointer;
      color: white;
    }
    .sc-controls input[type=range] {
      width: 100px;
    }
  </style>
</head>
<body>
  <div class="carousel" id="carousel">
    <div class="section">
      <div class="panel">
        <h1>Bienvenido a NSD</h1>
        <p>Explora nuestros enlaces:</p>
        <a href="https://bandcamp.com" target="_blank">Bandcamp</a>
        <a href="https://spotify.com" target="_blank">Spotify</a>
        <a href="https://instagram.com" target="_blank">Instagram</a>
        <a href="https://tiktok.com" target="_blank">TikTok</a>
        <a href="https://twitter.com" target="_blank">Twitter</a>
        <a href="https://soundcloud.com" target="_blank">SoundCloud</a>
      </div>
    </div>
    <div class="section">
      <div class="panel" style="width:90%; max-width:800px; position:relative;">
        <h2>Snake Game</h2>
        <canvas id="snakeCanvas" width="400" height="400"></canvas>
        <div id="snakeUI">
          <span id="score">Score: 0</span> | 
          <span id="lives">Lives: 2</span>
        </div>
        <div id="ranking">
          <strong>Ranking:</strong>
          <ol id="rankingList"></ol>
        </div>
        <div class="overlay" id="overlay" style="display:none;">
          <div id="gameOverText">Game Over</div>
          <div>
            <input type="text" id="nickname" placeholder="Tu nombre"/>
            <button id="submitScore">Guardar Score</button>
          </div>
        </div>
      </div>
    </div>
    <div class="section">
      <div class="panel">
        <h2>Player</h2>
        <div id="soundcloud-player">
          <iframe id="sc-widget" width="100%" height="120" scrolling="no" frameborder="no" allow="autoplay" 
            src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/playlists/1516788252&color=%23ff5500&inverse=false&auto_play=false&show_user=true"></iframe>
          <div class="sc-controls">
            <button id="prevBtn">⏮</button>
            <button id="playBtn">▶️</button>
            <button id="nextBtn">⏭</button>
            <label>Vol <input type="range" id="volumeSlider" min="0" max="100" value="50"></label>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="arrow left" onclick="scrollCarousel(-1)">❮</div>
  <div class="arrow right" onclick="scrollCarousel(1)">❯</div>

<script src="https://w.soundcloud.com/player/api.js"></script>
<script>
  const carousel=document.getElementById('carousel');
  function scrollCarousel(dir){
    const width=window.innerWidth;
    carousel.scrollBy({left:dir*width,behavior:'smooth'});
  }

  // flechas dinámicas
  function updateArrows(){
    const maxScroll=carousel.scrollWidth-carousel.clientWidth;
    document.querySelector(".arrow.left").style.display=carousel.scrollLeft<=10?"none":"block";
    document.querySelector(".arrow.right").style.display=carousel.scrollLeft>=maxScroll-10?"none":"block";
  }
  carousel.addEventListener("scroll",updateArrows);
  window.addEventListener("resize",updateArrows);
  updateArrows();

  // swipe carrusel móvil
  let startX=null;
  carousel.addEventListener("touchstart",e=>{startX=e.touches[0].clientX;},{passive:true});
  carousel.addEventListener("touchend",e=>{
    if(startX===null) return;
    const dx=e.changedTouches[0].clientX-startX;
    if(Math.abs(dx)>50){scrollCarousel(dx>0?-1:1);}
    startX=null;
  });

  // snake
  const canvas=document.getElementById("snakeCanvas");
  const ctx=canvas.getContext("2d");
  const box=20;
  let snake=[{x:10,y:10},{x:9,y:10},{x:8,y:10}];
  let dir={x:1,y:0}, pendingDir=null;
  let food={x:15,y:10};
  let score=0, lives=2;
  const SPEED=120;
  let gameLoop=null;
  let ranking=[];
  const overlay=document.getElementById("overlay");
  const scoreSpan=document.getElementById("score");
  const livesSpan=document.getElementById("lives");
  const rankingList=document.getElementById("rankingList");
  const nicknameInput=document.getElementById("nickname");
  const submitScoreBtn=document.getElementById("submitScore");

  function drawSnake(){
    ctx.fillStyle="black"; ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="lime";
    snake.forEach(p=>ctx.fillRect(p.x*box,p.y*box,box-2,box-2));
    ctx.fillStyle="red"; ctx.fillRect(food.x*box,food.y*box,box-2,box-2);
  }
  function placeFood(){food={x:Math.floor(Math.random()*canvas.width/box),y:Math.floor(Math.random()*canvas.height/box)};}
  function resetSnake(){
    snake=[{x:10,y:10},{x:9,y:10},{x:8,y:10}];
    dir={x:1,y:0}; pendingDir=null; score=0; placeFood();
    lives=2; 
    overlay.style.display="none";
    if(gameLoop) clearInterval(gameLoop);
    gameLoop=setInterval(step,SPEED);
    drawSnake();
  }
  function step(){
    if(pendingDir){dir=pendingDir; pendingDir=null;}
    const head={x:snake[0].x+dir.x,y:snake[0].y+dir.y};
    if(head.x<0||head.y<0||head.x>=canvas.width/box||head.y>=canvas.height/box||snake.some(p=>p.x===head.x&&p.y===head.y)){
      lives--; livesSpan.textContent="Lives: "+lives;
      if(lives<0){gameOver(); return;}
      else{resetSnake(); return;}
    }
    snake.unshift(head);
    if(head.x===food.x&&head.y===food.y){score+=10; scoreSpan.textContent="Score: "+score; placeFood();}
    else snake.pop();
    drawSnake();
  }
  function gameOver(){
    clearInterval(gameLoop);
    document.getElementById("gameOverText").textContent="Game Over! Score: "+score;
    overlay.style.display="flex";
  }
  document.addEventListener("keydown",e=>{
    if(e.key==="ArrowUp"&&dir.y===0) pendingDir={x:0,y:-1};
    if(e.key==="ArrowDown"&&dir.y===0) pendingDir={x:0,y:1};
    if(e.key==="ArrowLeft"&&dir.x===0) pendingDir={x:-1,y:0};
    if(e.key==="ArrowRight"&&dir.x===0) pendingDir={x:1,y:0};
  });
  let touchStartX=null,touchStartY=null;
  canvas.addEventListener("touchstart",e=>{touchStartX=e.touches[0].clientX; touchStartY=e.touches[0].clientY;},{passive:true});
  canvas.addEventListener("touchend",e=>{
    const dx=e.changedTouches[0].clientX-touchStartX;
    const dy=e.changedTouches[0].clientY-touchStartY;
    if(Math.abs(dx)>Math.abs(dy)){
      if(dx>50&&dir.x===0) pendingDir={x:1,y:0};
      if(dx<-50&&dir.x===0) pendingDir={x:-1,y:0};
    } else {
      if(dy>50&&dir.y===0) pendingDir={x:0,y:1};
      if(dy<-50&&dir.y===0) pendingDir={x:0,y:-1};
    }
  },{passive:true});

  function renderRanking(){
    rankingList.innerHTML="";
    ranking.slice(0,10).forEach(r=>{
      const li=document.createElement("li");
      li.textContent=r.name+": "+r.score;
      rankingList.appendChild(li);
    });
  }
  function loadRanking(){
    const saved=JSON.parse(localStorage.getItem("nsdRanking")||"[]");
    ranking=saved;
    renderRanking();
  }
  function saveRanking(){
    localStorage.setItem("nsdRanking",JSON.stringify(ranking));
  }
  submitScoreBtn.addEventListener("click",()=>{
    const name=(nicknameInput.value||"Anon").slice(0,12);
    ranking.push({name,score});
    ranking.sort((a,b)=>b.score-a.score);
    saveRanking();
    renderRanking();
    nicknameInput.value="";
    resetSnake();
  });
  loadRanking();
  resetSnake();

  // soundcloud
  const scWidget=SC.Widget(document.getElementById("sc-widget"));
  let isPlaying=false;
  const playBtn=document.getElementById("playBtn");
  const nextBtn=document.getElementById("nextBtn");
  const prevBtn=document.getElementById("prevBtn");
  const volumeSlider=document.getElementById("volumeSlider");
  let widgetReady=false;
  scWidget.bind(SC.Widget.Events.READY,()=>{
    widgetReady=true;
    scWidget.setVolume(50);
  });
  playBtn.addEventListener("click",()=>{
    if(!widgetReady)return;
    if(isPlaying){scWidget.pause(); playBtn.textContent="▶️";} 
    else {scWidget.play(); playBtn.textContent="⏸";}
    isPlaying=!isPlaying;
  });
  nextBtn.addEventListener("click",()=>{if(widgetReady) scWidget.next();});
  prevBtn.addEventListener("click",()=>{if(widgetReady) scWidget.prev();});
  let volumeTimeout;
  volumeSlider.addEventListener("input",e=>{
    if(!widgetReady)return;
    clearTimeout(volumeTimeout);
    const v=Math.max(0,Math.min(100,parseInt(e.target.value,10)));
    volumeTimeout=setTimeout(()=>scWidget.setVolume(v),100);
  });
</script>
</body>
</html>

